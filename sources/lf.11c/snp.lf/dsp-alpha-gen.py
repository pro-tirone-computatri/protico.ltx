import ipaddress
import sys
import datetime
import random

myData=[
  ["2024-05-13T07:00",182,116,66],
  ["2024-05-14T06:30",158,110,75],
  ["2024-05-14T21:05",185,103,70],
  ["2024-05-15T06:45",179,113,67],
  ["2024-05-16T08:00",170,108,78],
  ["2024-05-17T07:10",195,111,65],
  ["2024-05-17T21:40",183,105,64],
  ["2024-05-18T03:50",188,110,62],
  ["2024-05-19T05:45",204,112,65],
  ["2024-05-19T18:50",176,112,68],
  ["2024-05-20T10:00",176,108,96],
  ["2024-05-21T22:00",177,115,69],
  ["2024-05-22T06:30",166,114,65],
  ["2024-05-22T18:30",180,108,76],
  ["2024-05-23T07:15",177,107,67],
  ["2024-05-24T10:30",168,108,76],
  ["2024-05-24T21:30",178,104,71],
  ["2024-05-25T06:30",161,115,69],
  ["2024-05-25T21:40",165,91,81],
  ["2024-05-26T06:30",177,105,72],
  ["2024-05-26T21:50",170,102,74],
  ["2024-05-27T06:30",156,104,69],
  ["2024-05-27T21:30",183,105,65],
  ["2024-05-28T06:30",168,108,70],
  ["2024-05-29T06:15",170,106,73],
  ["2024-06-03T08:10",170,102,62],
  ["2024-06-03T21:40",194,108,64],
  ["2024-06-04T06:50",151,101,62],
  ["2024-06-05T14:45",119,77,73],
  ["2024-06-05T22:55",150,90,68],
  ["2024-06-06T05:40",154,92,63],
  ["2024-06-06T09:00",146,86,70],
  ["2024-06-06T21:50",158,94,73],
  ["2024-06-07T05:55",151,97,61],
  ["2024-06-07T22:00",148,88,66],
  ["2024-06-08T08:00",164,100,64],
  ["2024-06-08T22:00",177,103,65],
  ["2024-06-09T05:20",150,92,66],
  ["2024-06-09T07:40",168,98,72],
  ["2024-06-09T22:00",153,91,72],
  ["2024-06-10T21:45",165,101,67],
  ["2024-06-11T07:00",153,105,67],
  ["2024-06-12T22:00",158,98,65],
  ["2024-06-13T07:00",166,98,61],
  ["2024-06-22T07:30",156,106,70],
  ["2024-06-22T23:30",152,96,78],
  ["2024-06-23T06:20",156,100,60],
  ["2024-06-23T22:20",151,85,80],
  ["2024-06-24T08:30",165,97,71],
  ["2024-06-25T21:30",161,115,70],
  ["2024-06-26T07:20",175,103,74],
  ["2024-06-26T22:00",135,97,74],
  ["2024-06-27T07:00",153,100,86],
  ["2024-06-27T21:30",153,89,74],
  ["2024-06-27T06:30",153,97,68],
  ["2024-06-28T22:30",152,100,62],
  ["2024-06-29T21:40",154,92,72],
  ["2024-06-30T08:45",157,95,68],
  ["2024-06-30T21:45",153,93,76],
  ["2024-07-01T23:30",162,102,77],
  ["2024-07-02T06:20",155,101,66],
  ["2024-07-03T23:20",165,105,68],
  ["2024-07-04T05:30",165,95,64],
  ["2024-07-05T23:20",165,95,70],
  ["2024-07-08T06:30",156,98,59],
  ["2024-07-09T22:00",160,102,68],
  ["2024-07-10T05:30",158,100,84],
  ["2024-07-11T22:00",158,98,70],
  ["2024-07-12T07:55",162,100,70],
  ["2024-07-12T22:30",157,99,66],
  ["2024-07-13T08:00",173,101,67],
  ["2024-07-13T22:00",158,98,65],
  ["2024-07-15T11:50",172,110,72],
  ["2024-07-16T12:00",162,104,69],
  ["2024-07-17T22:00",171,95,63],
  ["2024-07-18T06:30",151,97,63],
  ["2024-07-18T21:30",151,101,73],
  ["2024-07-19T07:00",149,93,67],
  ["2024-07-19T21:40",148,96,81],
  ["2024-07-20T07:50",144,96,83],
  ["2024-07-20T21:45",162,94,72],
  ["2024-07-21T21:00",147,91,72],
  ["2024-07-21T07:15",142,92,82],
  ["2024-07-21T21:40",148,96,73],
  ["2024-07-23T06:30",141,101,75],
  ["2024-07-23T22:00",143,103,83],
  ["2024-07-24T08:30",155,99,77],
  ["2024-07-24T21:50",139,87,86],
  ["2024-07-25T07:00",125,89,80],
  ["2024-07-25T21:40",139,85,84],
  ["2024-07-26T06:50",142,94,71],
  ["2024-07-26T21:45",147,95,77],
  ["2024-07-27T06:50",145,85,74],
  ["2024-07-27T22:00",155,99,73],
  ["2024-08-02T22:30",134,90,83],
  ["2024-08-03T08:00",154,94,73],
  ["2024-08-04T22:30",152,98,75],
  ["2024-08-05T06:00",143,103,67],
  ["2024-08-06T22:00",155,97,80],
  ["2024-06-06T06:00",151,97,72],
  ["2024-08-06T21:30",157,91,72],
  ["2024-07-08T21:40",157,91,72],
  ["2024-08-08T21:40",157,91,76],
  ["2024-08-09T07:00",141,102,72],
  ["2024-08-09T21:45",132,92,71],
  ["2024-08-10T07:00",128,82,81],
  ["2024-08-10T24:00",154,99,81],
  ["2024-08-11T06:50",146,96,70],
  ["2024-08-13T06:30",152,96,76],
  ["2024-08-15T06:00",154,96,71],
  ["2024-08-16T21:40",142,88,72],
  ["2024-08-17T21:10",144,88,73],
  ["2024-08-18T23:55",147,95,80],
  ["2024-08-21T22:00",162,97,65],
  ["2024-09-01T21:30",164,86,82],
  ["2024-09-02T23:30",156,86,82],
  ["2024-09-04T22:15",147,95,87],
  ["2024-09-06T22:00",152,90,75],
  ["2024-09-10T00:30",153,101,71],
  ["2024-09-20T06:30",140,98,72],
  ["2024-10-02T22:00",133,87,80],
  ["2024-10-13T22:30",139,91,76],
  ["2024-10-14T22:30",131,89,61],
  ["2024-10-29T21:15",139,89,74],
  ["2024-11-10T06:00",130,90,64],
  ["2024-12-02T00:00",146,90,76],
  ["2024-12-02T06:00",143,97,70],
  ["2024-12-02T07:00",152,90,74],
  ["2025-01-01T",100,158,67],
  # [2025/01 - 202502] 
  # a) wrong timestamp syntax & 
  # diastolic and systolic values swapped
  ["2025-01-08T",104,158,71],
  ["2025-01-08T",95,139,79],
  ["2025-01-09T",85,123,66],
  ["2025-01-09T",93,175,65],
  ["2025-01-10T",82,144,78],
  ["2025-01-13T",95,153,66],
  ["2025-01-13T",91,157,73],
  ["2025-01-14T",78,128,79],
  ["2025-01-15T",104,168,68],
  ["2025-01-17T",97,149,61],
  ["2025-01-18T",107,149,76],
  ["2025-01-19T",95,139,95],       
  ["2025-01-20T",104,148,76],
  ["2025-01-21T",89,129,89],
  ["2025-01-22T",104,154,71],
  ["2025-01-28T",89,135,69],
  ["2025-28-31T",95,139,74],
  ["2025-02-08T",87,129,76],
  ["2025-02-17T",10,134,88],      
  # THIS ENTRY: diastolic value extra ordinary too low: forgotten 0
  ["2025-02-19T",97,147,69],
  ["2025-02-23T",90,170,87],
  ["2025-02-23T",99,169,90],
  ["2025-02-24T",97,139,78],
  # Martch entries: wrong timestamp format
  ["Mon Mar 03 06:00:00 AM CET 2025",131,91,83], # Restart valid section
  ["Sun Mar 09 07:00:00 AM CET 2025",148,90,70],
  ["Mon Mar 10 08:00:00 AM CET 2025",133,89,70],
  ["Fri Mar 21 07:30:00 PM CET 2025",146,100,68],
  ["Sat Mar 22 08:00:00 AM CET 2025",157,91,70],
  ["Sun Mar 23 07:00:00 AM CET 2025",142,88,66],
  ["Sun Mar 23 09:00:00 PM CET 2025",158,98,77],
  ["Mon Mar 24 07:30:00 AM CET 2025",147,95,71],
  ["Tue Mar 25 06:15:00 AM CET 2025",145,103,76],
  ["Mon Mar 31 06:00:00 AM CET 2025", 107,77,79],
  ["2025-04-01T02:00", 182,110,83]
]

def writeData(fname,farray,fstyle) :
  with open(fname, 'w') as fp:
    i=0
    for vset in farray:
      print('writing {} line {}'.format(fname,i))
      match fstyle:
        case 'authentic':
          fp.write('{}{}{}{}'.format(vset[0],chr(vset[1]),chr(vset[2]),chr(vset[3])))
        case 'shuffled':
          fp.write('{}{}{}{}'.format(vset[0],chr(vset[1]),chr(vset[2]),chr(vset[3])))
        case 'csv':
          fp.write('{},{},{},{},{}\n'.format(i,vset[0],vset[1],vset[2],vset[3]))
        case 'txt':
          fp.write('{},{},{},{}'.format(vset[0],vset[1],vset[2],vset[3]))
        case _:
            print('unknown fstyle')
      i+=1
  fp.close()


# main sectionls

data_smp="dsp.alpha"
dsmp_pur=data_smp + ".xyz"
dsmp_ord=data_smp + ".ordered.xyz"
dsmp_csv=data_smp + ".csv"
dsmp_txt=data_smp + ".txt"

writeData(dsmp_ord,myData,'authentic')
writeData(dsmp_pur,random.sample(myData,len(myData)),'authentic')
writeData(dsmp_csv,myData,'csv')
writeData(dsmp_txt,myData,'txt')
